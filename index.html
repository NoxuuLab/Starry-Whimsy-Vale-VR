<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Reality Scene</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
    <script src="https://rawgit.com/zcanter/aframe-gradient-sky/master/dist/gradientsky.min.js"></script>

    
    <script src="light-toggle.js"></script>
</head>
<body>
    <a-scene cursor="rayOrigin:mouse" fog="type: linear; color: #AAA">
        <!-- ASSETS -->
        <a-assets>
            <a-asset-item id="geisha" src="assets/main_scene/ghost-in-the-shell-geisha-mask/source/model.glb"></a-asset-item>

            <a-asset-item id="texture" src="assets/main_scene/stone-texture.jpg"></a-asset-item>
            <audio id="geisha-sound" src="assets/main_scene/cricket.mp3" controls aria-label="geisha-s"></audio>
        </a-assets>

        <!-- ENVIRONMENT -->
        <a-entity environment="
                fog: 0.9;
                groundColor: #fff; 
                preset: dream; 
                groundTexture: none;
                groundColor: #fff;  
                grid: none;
                groundYScale: 60;
                dressing: none">
        </a-entity>

        <!-- CAMERA -->
        <a-entity id="rig">
            <a-entity camera look-controls position="0 1.6 0"></a-entity>
            <a-cursor raycaster="objects: .interactive"></a-cursor>
        </a-entity>

        <!-- LIGHTS -->
        <!-- Ambient light for the scene -->
        <a-light type="ambient" color="#888"></a-light>

        <!-- gradient sphere -->
      <a-entity geometry="primitive: sphere"
                material="shader: gradient; topColor: 255 100 100; bottomColor: 100 100 200; offset: 0.0001"
                position="-1 2.8 -4" >
            <a-sound src="#geisha-sound" autoplay="false" loop="true"></a-sound>
        <a-entity onclick="toggleSound('lampSound1')"></a-entity>
        </a-sphere>
        <a-light type="spot" position="3 5 3"  angle="45" penumbra="0.8" intensity="1"></a-light>
        
        <a-entity geometry="primitive: sphere"
          material="color: #00FF00; opacity: 0.6; side: double;  repeat: 2 2; roughness: 0.5;"
          position="-1 3 -7" >
</a-entity>

      <!-- JavaScript to create circles with radius lines -->
      <script>
        AFRAME.registerComponent('radius-lines', {
          init: function () {
            const numCircles = 5;  // Adjust the number of circles
            const radiusIncrement = 0.5;  // Adjust the radius increment between circles

            for (let i = 0; i < numCircles; i++) {
              const radius = i * radiusIncrement;

              // Create a ring entity (annular geometry)
              const ringEntity = document.createElement('a-ring');
              ringEntity.setAttribute('radius-inner', radius - 0.01);  // Adjust inner radius
              ringEntity.setAttribute('radius-outer', radius + 0.01);  // Adjust outer radius
              ringEntity.setAttribute('material', { color: '#00FF00', side: 'double' });

              // Position each ring along the y-axis
              ringEntity.setAttribute('position', `0 ${i * 0.2} 0`);

              // Append the ring entity to the scene
              this.el.appendChild(ringEntity);
            }
          }
        });
      </script>

      <!-- Use the radius-lines component to create the circles -->
      <a-entity radius-lines position="-1 3 -4"></a-entity>
    </a-scene>

    <script>
        function toggleSound(soundId) {
            var sound = document.getElementById(soundId);

            // Attempt to play the sound after a user gesture
            document.body.addEventListener('click', function() {
                // Check if the Web Audio API is suspended and resume it if needed
                if (typeof sound.context !== 'undefined' && sound.context.state === 'suspended') {
                    sound.context.resume().then(() => {
                        console.log('AudioContext resumed');
                        sound.play();
                    });
                } else {
                    sound.play();
                }

                // Remove the click event listener to avoid multiple attempts
                document.body.removeEventListener('click', arguments.callee);
            });
        }
    </script>
  
</body>
</html>
